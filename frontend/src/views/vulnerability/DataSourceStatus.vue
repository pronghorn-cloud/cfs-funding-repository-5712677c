<script setup lang="ts">
import { ref } from 'vue'
import { useNotificationsStore } from '@/stores/notifications'

const notifications = useNotificationsStore()

// Placeholder data sources
const dataSources = ref([
  { name: 'Statistics Canada', type: 'statscan', status: 'active', lastFetched: '2024-12-01' },
  { name: 'GoA Health', type: 'goa_health', status: 'active', lastFetched: '2024-11-15' },
  { name: 'Environics Analytics', type: 'environics', status: 'configured', lastFetched: null },
  { name: 'CFS Internal', type: 'cfs_internal', status: 'active', lastFetched: '2024-12-10' },
  { name: 'SCSS', type: 'scss', status: 'active', lastFetched: '2024-12-08' },
  { name: 'Recovery Alberta', type: 'recovery_alberta', status: 'configured', lastFetched: null },
  { name: 'Justice', type: 'justice', status: 'configured', lastFetched: null },
])

function triggerIngestion(sourceName: string) {
  notifications.info(`Ingestion triggered for ${sourceName}`)
}
</script>

<template>
  <div>
    <h1 class="text-3xl font-bold mb-6">Data Source Status</h1>

    <div class="bg-white rounded-lg shadow">
      <goa-table class="w-full">
        <thead>
          <tr>
            <th>Data Source</th>
            <th>Type</th>
            <th>Status</th>
            <th>Last Fetched</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="ds in dataSources" :key="ds.type">
            <td class="font-medium">{{ ds.name }}</td>
            <td>{{ ds.type }}</td>
            <td>
              <goa-badge
                :content="ds.status"
                :type="ds.status === 'active' ? 'success' : 'midtone'"
              />
            </td>
            <td>{{ ds.lastFetched || 'Never' }}</td>
            <td>
              <goa-button
                type="secondary"
                size="compact"
                @_click="triggerIngestion(ds.name)"
              >
                Trigger Ingestion
              </goa-button>
            </td>
          </tr>
        </tbody>
      </goa-table>
    </div>
  </div>
</template>
